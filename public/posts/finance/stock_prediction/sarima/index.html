<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>Time Series Analysis and SARIMA Model for Stock Price Prediction</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />

<link rel="stylesheet" href="/application.fba7e2c0b4d0535aec97a3442d40338651f3354b1ee38f3630059796de18930f.css" integrity="sha256-&#43;6fiwLTQU1rsl6NELUAzhlHzNUse4482MAWXlt4Ykw8=" />





  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="/images/site/icon_hu65d76dfee5a8e0802e55f59432358110_6732567_42x0_resize_box_3.png" />

<meta property="og:url" content="http://localhost:1313/posts/finance/stock_prediction/sarima/">
  <meta property="og:site_name" content="Stefano Giannini">
  <meta property="og:title" content="Time Series Analysis and SARIMA Model for Stock Price Prediction">
  <meta property="og:description" content="Short Stock price analysis on AAPL, then a prediction is tested using SARIMA model">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-04T00:00:00+01:00">
    <meta property="article:modified_time" content="2024-07-04T00:00:00+01:00">
    <meta property="article:tag" content="Finance">
    <meta property="article:tag" content="Statistics">
    <meta property="article:tag" content="Forecasting">

    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Time Series Analysis and SARIMA Model for Stock Price Prediction">
  <meta name="twitter:description" content="Short Stock price analysis on AAPL, then a prediction is tested using SARIMA model">

    
    
<meta name="description" content="Short Stock price analysis on AAPL, then a prediction is tested using SARIMA model" />


    

    




<script>
      theme = localStorage.getItem('darkmode:color-scheme') || 'system';
      if (theme == 'system') {
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          theme = 'dark';
        } else {
          theme = 'light';
        }
      }
      document.documentElement.setAttribute('data-theme', theme);
    </script>
  </head>

  <body class="type-posts kind-page" data-bs-spy="scroll" data-bs-target="#TableOfContents" data-bs-offset="80">
    <div class="container-fluid bg-secondary wrapper">
      
      
    













  


  




  
  
    
  
  



  
  
    
  
  







  




  




  


<nav class="navbar navbar-expand-xl top-navbar shadow " id="top-navbar">
  <div class="container">
    
    <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button">
      <i data-feather="sidebar"></i>
    </button>
    
    <a class="navbar-brand" href="/">
      
        <img src="/images/site/icon_hu65d76dfee5a8e0802e55f59432358110_6732567_42x0_resize_box_3.png" id="logo" alt="Logo">
      Stefano Giannini</a>
    <button
      class="navbar-toggler navbar-light"
      id="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#top-nav-items"
      aria-label="menu"
    >
      <i data-feather="menu"></i>
    </button>

    <div class="collapse navbar-collapse dynamic-navbar" id="top-nav-items">
      <ul class="nav navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="/#home">Home</a>
        </li>
        
          
          
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#about">About</a>
                </li>
              
            
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#skills">Skills</a>
                </li>
              
            
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#experiences">Experiences</a>
                </li>
              
            
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#education">Education</a>
                </li>
              
            
          
        
        
          <div id="top-navbar-divider"></div>
        
        
          <li class="nav-item">
            <a class="nav-link" id="blog-link" href="/posts">Posts</a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" id="note-link" href="/notes">Notes</a>
          </li>
        
        
            
              <li class="nav-item">
                <a class="nav-link" href="https://toha-guides.netlify.app/posts/">Docs</a>
              </li>
            
        
        
        
          <li class="nav-item dropdown">
<a class="nav-link dropdown-toggle"  href="#" id="themeSelector" role="button"
  data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
  <img id="navbar-theme-icon-svg" class="theme-icon" src="/icons/moon-svgrepo-com.svg" width=20 alt="Dark Theme">
</a>
<div id="themeMenu" class="dropdown-menu dropdown-menu-icons-only" aria-labelledby="themeSelector">
  <a class="dropdown-item nav-link" href="#" data-scheme="light">
    <img class="theme-icon" src="/icons/sun-svgrepo-com.svg" width=20 alt="Light Theme">
  </a>
  <a class="dropdown-item nav-link" href="#" data-scheme="dark">
    <img class="theme-icon" src="/icons/moon-svgrepo-com.svg" width=20 alt="Dark Theme">
  </a>
  <a class="dropdown-item nav-link" href="#" data-scheme="system">
    <img class="theme-icon" src="/icons/computer-svgrepo-com.svg" width=20 alt="System Theme">
  </a>
</div>
</li>

        
      </ul>
    </div>
  </div>
  
  
    <img src="/images/site/icon_hu65d76dfee5a8e0802e55f59432358110_6732567_42x0_resize_box_3.png" class="d-none" id="main-logo" alt="Logo">
  
  
    <img src="/images/site/icon_hu65d76dfee5a8e0802e55f59432358110_6732567_42x0_resize_box_3.png" class="d-none" id="inverted-logo" alt="Inverted Logo">
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts/" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
    
    
  
  
    
    <li>
      <i data-feather="minus-circle"></i><a class="active list-link" href="/posts/finance/"> Finance</a>
      
      <ul class="active">
        
  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/finance/monte_carlo/"> Monte Carlo</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/finance/monte_carlo/black-scholes/" title="Option Pricing">Option Pricing</a></li>
  


      </ul>
    </li>
  

  
  
  
  
    
    
  
  
    
    <li>
      <i data-feather="minus-circle"></i><a class="active list-link" href="/posts/finance/stock_prediction/"> Stock Prediction</a>
      
      <ul class="active">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/finance/stock_prediction/gru/" title="GRU">GRU</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/finance/stock_prediction/arima/" title="ARIMA">ARIMA</a></li>
  

  
  
  
  
    
    
  
  
    
    <li><a class="active list-link" href="/posts/finance/stock_prediction/sarima/" title="SARIMA">SARIMA</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/finance/stock_prediction/sarimax/" title="SARIMAX">SARIMAX</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/machine-learning/"> Machine Learning</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/machine-learning/deep-learning/"> Deep Learning</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/machine-learning/deep-learning/computer-vision/"> Computer Vision</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/machine-learning/deep-learning/computer-vision/florence/" title="Florence-2 LVM">Florence-2 LVM</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/physics/"> Physics</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/physics/percolation/" title="Percolation">Percolation</a></li>
  

  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/physics/quantum_computing/"> Quantum Computing</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/physics/quantum_computing/introduction/" title="Introduction">Introduction</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/physics/quantum_computing/teleportation/" title="Teleportation">Teleportation</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(/posts/finance/stock_prediction/sarima/images/sarima_example_9_1.png);'>
      </div>

      
      <div class="page-content">
        
        <div class="author-profile ms-auto align-self-lg-center">
          <img class="rounded-circle" src='/images/author/profile_hu8a567cefac8c1a165d433ac0796ac418_3088978_120x120_fit_q75_box.jpg' alt="Author Image">
          <h5 class="author-name">Stefano Giannini</h5>
          <p class="text-muted">Thursday, July 4, 2024 | 6 minutes</p>
        </div>
        
        
        <div class="title">
          <h1>Time Series Analysis and SARIMA Model for Stock Price Prediction</h1>
        </div>

        

        
          <div class="tags">
  <ul style="padding-left: 0;">
    
    
    <li class="rounded"><a href="/tags/finance/" class="btn btn-sm btn-info">Finance</a></li>
    
    
    <li class="rounded"><a href="/tags/statistics/" class="btn btn-sm btn-info">Statistics</a></li>
    
    
    <li class="rounded"><a href="/tags/forecasting/" class="btn btn-sm btn-info">Forecasting</a></li>
    
  </ul>
</div>

        
        <div class="post-content" id="post-content">
          <h2 id="introduction">Introduction</h2>
<p>The Seasonal Autoregressive Integrated Moving Average (SARIMA) model is an extension of the ARIMA model (discussed in the <a href="/posts/finance/stock_prediction/arima/">previous article</a>) that incorporates seasonality. This makes it particularly useful for analyzing financial time series data, which often exhibits both trend and seasonal patterns. In this article, we&rsquo;ll apply the SARIMA model to Apple (AAPL) stock data, perform signal decomposition, and provide a detailed mathematical explanation of the model.</p>
<h2 id="1-data-preparation-and-exploration">1. Data Preparation and Exploration</h2>
<p>First, let&rsquo;s obtain the Apple stock data and prepare it for analysis:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> yfinance <span style="color:#66d9ef">as</span> yf
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> statsmodels.tsa.seasonal <span style="color:#f92672">import</span> seasonal_decompose
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> statsmodels.tsa.statespace.sarimax <span style="color:#f92672">import</span> SARIMAX
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> statsmodels.tsa.stattools <span style="color:#f92672">import</span> adfuller, acf, pacf
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pmdarima <span style="color:#f92672">import</span> auto_arima
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Download Apple stock data</span>
</span></span><span style="display:flex;"><span>ticker <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AAPL&#34;</span>
</span></span><span style="display:flex;"><span>start_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2022-01-01&#34;</span>
</span></span><span style="display:flex;"><span>end_date <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2024-01-23&#34;</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> yf<span style="color:#f92672">.</span>download(ticker, start<span style="color:#f92672">=</span>start_date, end<span style="color:#f92672">=</span>end_date)
</span></span><span style="display:flex;"><span>df <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Use closing prices for our analysis</span>
</span></span><span style="display:flex;"><span>ts <span style="color:#f92672">=</span> data[<span style="color:#e6db74">&#39;Close&#39;</span>]<span style="color:#f92672">.</span>dropna()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot the time series</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(ts)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Apple Stock Closing Prices&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Date&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Price&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><pre><code>[*********************100%%**********************]  1 of 1 completed
</code></pre>
<p><img alt="png" src="/posts/finance/stock_prediction/sarima/images/sarima_example_1_1.png"></p>
<h2 id="2-signal-decomposition">2. Signal Decomposition</h2>
<p>Before we build our SARIMA model, it&rsquo;s crucial to understand the components of our time series. We&rsquo;ll use seasonal decomposition to break down the series into trend, seasonal, and residual components:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Perform seasonal decomposition</span>
</span></span><span style="display:flex;"><span>decomposition <span style="color:#f92672">=</span> seasonal_decompose(ts, model<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;additive&#39;</span>, period<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>)  <span style="color:#75715e"># 252 trading days in a year</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>rcParams<span style="color:#f92672">.</span>update({<span style="color:#e6db74">&#39;figure.dpi&#39;</span>:<span style="color:#ae81ff">200</span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot the decomposition</span>
</span></span><span style="display:flex;"><span>fig, (ax1, ax2, ax3, ax4) <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">16</span>))
</span></span><span style="display:flex;"><span>decomposition<span style="color:#f92672">.</span>observed<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax1)
</span></span><span style="display:flex;"><span>ax1<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Observed&#39;</span>)
</span></span><span style="display:flex;"><span>decomposition<span style="color:#f92672">.</span>trend<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax2, c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r&#39;</span>)
</span></span><span style="display:flex;"><span>ax2<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Trend&#39;</span>)
</span></span><span style="display:flex;"><span>decomposition<span style="color:#f92672">.</span>seasonal<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax3, c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;k&#39;</span>)
</span></span><span style="display:flex;"><span>ax3<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Seasonal&#39;</span>)
</span></span><span style="display:flex;"><span>decomposition<span style="color:#f92672">.</span>resid<span style="color:#f92672">.</span>plot(ax<span style="color:#f92672">=</span>ax4, c<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;g&#39;</span>)
</span></span><span style="display:flex;"><span>ax4<span style="color:#f92672">.</span>set_title(<span style="color:#e6db74">&#39;Residual&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>tight_layout()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img alt="png" src="/posts/finance/stock_prediction/sarima/images/sarima_example_3_0.png"></p>
<p>This decomposition helps us understand:</p>
<ol>
<li><strong>Trend</strong>: The long-term progression of the series</li>
<li><strong>Seasonality</strong>: Repeating patterns or cycles</li>
<li><strong>Residual</strong>: The noise left after accounting for trend and seasonality</li>
</ol>
<h2 id="3-mathematical-formulation-of-sarima">3. Mathematical Formulation of SARIMA</h2>
<p>The SARIMA model is denoted as SARIMA(p,d,q)(P,D,Q)m, where:</p>
<ul>
<li>p, d, q: Non-seasonal orders of AR, differencing, and MA</li>
<li>P, D, Q: Seasonal orders of AR, differencing, and MA</li>
<li>m: Number of periods per season</li>
</ul>
<p>The mathematical formulation of SARIMA combines the non-seasonal and seasonal components:</p>
<ol>
<li>
<p><strong>Non-seasonal components</strong>:</p>
<ul>
<li>$AR(p): φ(B) = 1 - φ₁B - φ₂B² - &hellip; - φₚBᵖ$</li>
<li>$MA(q): θ(B) = 1 + θ₁B + θ₂B² + &hellip; + θ_qBq$</li>
</ul>
</li>
<li>
<p><strong>Seasonal components</strong>:</p>
<ul>
<li>$SAR(P): Φ(Bᵐ) = 1 - Φ₁Bᵐ - Φ₂B²ᵐ - &hellip; - Φ_PBᴾᵐ$</li>
<li>$SMA(Q): Θ(Bᵐ) = 1 + Θ₁Bᵐ + Θ₂B²ᵐ + &hellip; + Θ_QBQᵐ$</li>
</ul>
</li>
<li>
<p><strong>Differencing</strong>:</p>
<ul>
<li>Non-seasonal: $(1-B)ᵈ$</li>
<li>Seasonal: $(1-Bᵐ)D$</li>
</ul>
</li>
</ol>
<p>The complete SARIMA model can be written as:</p>
<p>$$φ(B)Φ(Bᵐ)(1-B)ᵈ(1-Bᵐ)D Yₜ = θ(B)Θ(Bᵐ)εₜ$$</p>
<p>Where:</p>
<ul>
<li>B is the backshift operator ($BYₜ = Yₜ₋₁$)</li>
<li>Yₜ is the time series</li>
<li>εₜ is white noise</li>
</ul>
<h2 id="4-sarima-model-implementation">4. SARIMA Model Implementation</h2>
<p>Now that we understand the components and mathematical formulation, let&rsquo;s implement the SARIMA model:
From the previous article we found that the best <em>(p,d,q)</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pmdarima.arima.utils <span style="color:#f92672">import</span> nsdiffs
</span></span><span style="display:flex;"><span>D <span style="color:#f92672">=</span> nsdiffs(ts,
</span></span><span style="display:flex;"><span>            m<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>,  <span style="color:#75715e"># commonly requires knowledge of dataset</span>
</span></span><span style="display:flex;"><span>            max_D<span style="color:#f92672">=</span><span style="color:#ae81ff">12</span>,
</span></span><span style="display:flex;"><span>            )  <span style="color:#75715e"># -&gt; 0</span>
</span></span><span style="display:flex;"><span>D
</span></span></code></pre></div><blockquote>
<p>0</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Create Training and Test</span>
</span></span><span style="display:flex;"><span>train <span style="color:#f92672">=</span> ts[:int(len(df)<span style="color:#f92672">*</span><span style="color:#ae81ff">0.8</span>)]
</span></span><span style="display:flex;"><span>test <span style="color:#f92672">=</span> ts[int(len(df)<span style="color:#f92672">*</span><span style="color:#ae81ff">0.8</span>):]
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">grid_search_sarima</span>(train, test, p_range, d_range, q_range, P_range, D_range, Q_range, m_range):
</span></span><span style="display:flex;"><span>    best_aic <span style="color:#f92672">=</span> float(<span style="color:#e6db74">&#39;inf&#39;</span>)
</span></span><span style="display:flex;"><span>    best_mape <span style="color:#f92672">=</span> float(<span style="color:#e6db74">&#39;inf&#39;</span>)
</span></span><span style="display:flex;"><span>    best_order <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> p <span style="color:#f92672">in</span> p_range:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> d <span style="color:#f92672">in</span> d_range:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> q <span style="color:#f92672">in</span> q_range:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> P <span style="color:#f92672">in</span> P_range:
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">for</span> D <span style="color:#f92672">in</span> D_range:
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">for</span> Q <span style="color:#f92672">in</span> Q_range:
</span></span><span style="display:flex;"><span>                            <span style="color:#66d9ef">for</span> m <span style="color:#f92672">in</span> m_range:
</span></span><span style="display:flex;"><span>                                <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                                    model <span style="color:#f92672">=</span> SARIMAX(train<span style="color:#f92672">.</span>values, order<span style="color:#f92672">=</span>(p,d,q), seasonal_order<span style="color:#f92672">=</span>(P,D,Q,m))
</span></span><span style="display:flex;"><span>                                    results <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit()
</span></span><span style="display:flex;"><span>                                    fc_series <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>Series(results<span style="color:#f92672">.</span>forecast(steps<span style="color:#f92672">=</span>len(test)), index<span style="color:#f92672">=</span>test<span style="color:#f92672">.</span>index)  <span style="color:#75715e"># 95% conf</span>
</span></span><span style="display:flex;"><span>                                    test_metrics <span style="color:#f92672">=</span> forecast_accuracy(fc_series<span style="color:#f92672">.</span>values, test<span style="color:#f92672">.</span>values)
</span></span><span style="display:flex;"><span>                                    <span style="color:#75715e"># if results.aic &lt; best_aic:</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#75715e">#     best_aic = results.aic</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#75715e">#     best_order = (p,d,q)</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#75715e"># print(f&#34;(p,d,q)=({p},{d},{q}) | (P,D,Q,m)=({P},{D},{Q},{m})&#34;, test_metrics[&#39;mape&#39;])</span>
</span></span><span style="display:flex;"><span>                                    <span style="color:#66d9ef">if</span> test_metrics[<span style="color:#e6db74">&#39;mape&#39;</span>] <span style="color:#f92672">&lt;</span> best_mape:
</span></span><span style="display:flex;"><span>                                        best_mape <span style="color:#f92672">=</span> test_metrics[<span style="color:#e6db74">&#39;mape&#39;</span>]
</span></span><span style="display:flex;"><span>                                        best_order <span style="color:#f92672">=</span> (p,d,q)
</span></span><span style="display:flex;"><span>                                        best_sorder <span style="color:#f92672">=</span> (P,D,Q,m)
</span></span><span style="display:flex;"><span>                                        print(<span style="color:#e6db74">&#34;temp best:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;(p,d,q)=(</span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{</span>d<span style="color:#e6db74">}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{</span>q<span style="color:#e6db74">}</span><span style="color:#e6db74">) | (P,D,Q,m)=(</span><span style="color:#e6db74">{</span>P<span style="color:#e6db74">}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{</span>D<span style="color:#e6db74">}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{</span>Q<span style="color:#e6db74">}</span><span style="color:#e6db74">,</span><span style="color:#e6db74">{</span>m<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#34;</span>, 
</span></span><span style="display:flex;"><span>                                            round(test_metrics[<span style="color:#e6db74">&#39;mape&#39;</span>], <span style="color:#ae81ff">4</span>))
</span></span><span style="display:flex;"><span>                                <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">Exception</span> <span style="color:#66d9ef">as</span> e:
</span></span><span style="display:flex;"><span>                                    print(e)
</span></span><span style="display:flex;"><span>                                    <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> best_order, best_sorder
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Accuracy metrics</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">forecast_accuracy</span>(forecast, actual):
</span></span><span style="display:flex;"><span>    mape <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>mean(np<span style="color:#f92672">.</span>abs(forecast <span style="color:#f92672">-</span> actual)<span style="color:#f92672">/</span>np<span style="color:#f92672">.</span>abs(actual))    <span style="color:#75715e"># MAPE</span>
</span></span><span style="display:flex;"><span>    me <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>mean(forecast <span style="color:#f92672">-</span> actual)                             <span style="color:#75715e"># ME</span>
</span></span><span style="display:flex;"><span>    mae <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>mean(np<span style="color:#f92672">.</span>abs(forecast <span style="color:#f92672">-</span> actual))                    <span style="color:#75715e"># MAE</span>
</span></span><span style="display:flex;"><span>    mpe <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>mean((forecast <span style="color:#f92672">-</span> actual)<span style="color:#f92672">/</span>actual)                   <span style="color:#75715e"># MPE</span>
</span></span><span style="display:flex;"><span>    rmse <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>mean((forecast <span style="color:#f92672">-</span> actual)<span style="color:#f92672">**</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">**</span><span style="color:#ae81ff">.5</span>                  <span style="color:#75715e"># RMSE</span>
</span></span><span style="display:flex;"><span>    corr <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>corrcoef(forecast, actual)[<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]                   <span style="color:#75715e"># corr</span>
</span></span><span style="display:flex;"><span>    mins <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>amin(np<span style="color:#f92672">.</span>hstack([forecast[:,<span style="color:#66d9ef">None</span>], 
</span></span><span style="display:flex;"><span>                              actual[:,<span style="color:#66d9ef">None</span>]]), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    maxs <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>amax(np<span style="color:#f92672">.</span>hstack([forecast[:,<span style="color:#66d9ef">None</span>], 
</span></span><span style="display:flex;"><span>                              actual[:,<span style="color:#66d9ef">None</span>]]), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    minmax <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> np<span style="color:#f92672">.</span>mean(mins<span style="color:#f92672">/</span>maxs)                             <span style="color:#75715e"># minmax</span>
</span></span><span style="display:flex;"><span>    acf1 <span style="color:#f92672">=</span> acf(forecast<span style="color:#f92672">-</span>test)[<span style="color:#ae81ff">1</span>]                                <span style="color:#75715e"># ACF1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span>({<span style="color:#e6db74">&#39;mape&#39;</span>:mape, <span style="color:#e6db74">&#39;me&#39;</span>:me, <span style="color:#e6db74">&#39;mae&#39;</span>: mae, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;mpe&#39;</span>: mpe, <span style="color:#e6db74">&#39;rmse&#39;</span>:rmse, <span style="color:#e6db74">&#39;acf1&#39;</span>:acf1, 
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;corr&#39;</span>:corr, <span style="color:#e6db74">&#39;minmax&#39;</span>:minmax})
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Determine optimal SARIMA parameters</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># model = auto_arima(ts, seasonal=True, m=12,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#                     start_p=0, start_q=0, start_P=1, start_Q=1,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#                     max_p=4, max_q=4, max_P=2, max_Q=2, d=1, D=1,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#                     trace=True, error_action=&#39;ignore&#39;, suppress_warnings=True, stepwise=True, out_of_sample=len(test))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(model.summary())</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Custom Grid Search</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># d = 1 # from </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># best_order, best_sorder = grid_search_sarima(train, test, range(0,3), [d], range(0,3), range(3), [D], range(3), [4, 8, 12])</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(f&#34;Best ARIMA order based on grid search: {best_order}&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Fit the SARIMA model</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># sarima_model = SARIMAX(ts, order=model.order, seasonal_order=model.seasonal_order) (2,1,2) | (P,D,Q,m)=(2,1,1,</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># sarima_model = SARIMAX(train, order=best_order, seasonal_order=best_sorder) #(2,1,2) | (P,D,Q,m)=(2,1,1,8)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print(best_order, best_sorder)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># sarima_model = SARIMAX(train, order=(2,1,2), seasonal_order=(6,0,6,8))</span>
</span></span><span style="display:flex;"><span>sarima_model <span style="color:#f92672">=</span> SARIMAX(train, order<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>), seasonal_order<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>results <span style="color:#f92672">=</span> sarima_model<span style="color:#f92672">.</span>fit()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(results<span style="color:#f92672">.</span>summary())
</span></span></code></pre></div><pre><code>                                      SARIMAX Results                                      
===========================================================================================
Dep. Variable:                               Close   No. Observations:                  412
Model:             SARIMAX(2, 1, 2)x(2, 2, [1], 8)   Log Likelihood               -1073.473
Date:                             Fri, 05 Jul 2024   AIC                           2162.947
Time:                                     20:16:14   BIC                           2194.778
Sample:                                          0   HQIC                          2175.558
                                             - 412                                         
Covariance Type:                               opg                                         
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
ar.L1          0.0464      0.051      0.902      0.367      -0.054       0.147
ar.L2          0.8356      0.048     17.504      0.000       0.742       0.929
ma.L1         -0.0003    290.396  -1.14e-06      1.000    -569.165     569.164
ma.L2         -0.9997    290.178     -0.003      0.997    -569.739     567.739
ar.S.L8       -0.6368      0.047    -13.574      0.000      -0.729      -0.545
ar.S.L16      -0.2957      0.042     -7.043      0.000      -0.378      -0.213
ma.S.L8       -1.0000   3741.746     -0.000      1.000   -7334.687    7332.687
sigma2        11.5312   4.29e+04      0.000      1.000    -8.4e+04     8.4e+04
===================================================================================
Ljung-Box (L1) (Q):                   0.14   Jarque-Bera (JB):                23.66
Prob(Q):                              0.71   Prob(JB):                         0.00
Heteroskedasticity (H):               0.40   Skew:                            -0.04
Prob(H) (two-sided):                  0.00   Kurtosis:                         4.20
===================================================================================

Warnings:
[1] Covariance matrix calculated using the outer product of gradients (complex-step).
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># sarima_model = SARIMAX(train, order=(2,1,2), seasonal_order=(2,2,1,8))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># results = sarima_model.fit()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Forecast</span>
</span></span><span style="display:flex;"><span>forecast_steps <span style="color:#f92672">=</span> len(test) <span style="color:#75715e"># Forecast for one year</span>
</span></span><span style="display:flex;"><span>forecast <span style="color:#f92672">=</span> results<span style="color:#f92672">.</span>get_forecast(steps<span style="color:#f92672">=</span>forecast_steps)
</span></span><span style="display:flex;"><span>forecast_ci <span style="color:#f92672">=</span> forecast<span style="color:#f92672">.</span>conf_int(alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># forecast_index = pd.date_range(start=test.index[0]+pd.Timedelta(24, &#39;hours&#39;), periods=len(forecast_ci))</span>
</span></span><span style="display:flex;"><span>forecast_index <span style="color:#f92672">=</span> test<span style="color:#f92672">.</span>index
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Plot the forecast</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(train[<span style="color:#f92672">-</span><span style="color:#ae81ff">200</span>:], label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;training&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># plt.plot(ts.index, ts, label=&#39;Observed&#39;)</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(test, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;actual&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(forecast_index, forecast<span style="color:#f92672">.</span>predicted_mean <span style="color:#f92672">+</span> decomposition<span style="color:#f92672">.</span>seasonal[test<span style="color:#f92672">.</span>index]<span style="color:#f92672">.</span>values<span style="color:#f92672">*</span><span style="color:#ae81ff">10</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;r&#39;</span>, label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;forecast&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>fill_between(forecast_index, forecast_ci<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">0</span>], forecast_ci<span style="color:#f92672">.</span>iloc[:, <span style="color:#ae81ff">1</span>], color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pink&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.4</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;SARIMA Forecast of </span><span style="color:#e6db74">{</span>ticker<span style="color:#e6db74">}</span><span style="color:#e6db74"> Stock Prices&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Date&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Price&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img alt="png" src="/posts/finance/stock_prediction/sarima/images/sarima_example_9_1.png"></p>
<p>As the previous plot shows, SARIMA model takes into account stagionality with respect to the <a href="%28/posts/finance/stock_prediction/arima/%29">ARIMA model</a> and provides better accuracy and <em>mape</em> score (5% vs. 7%). Moreover, the stagionality can deal with temporary detachment from the mean value.
Nonetheless, SARIMA model is slower to train and to interfer (respectively $\approx 100\% $ and $50\%$ more). It still does not involve exogenous variables (possible with SARIMAX) and potential outbreaks (like Covid-19 or holidays).</p>
<h2 id="5-model-diagnostics">5. Model Diagnostics</h2>
<p>After fitting the model, it&rsquo;s important to check its adequacy:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Model diagnostics</span>
</span></span><span style="display:flex;"><span>results<span style="color:#f92672">.</span>plot_diagnostics(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><p><img alt="png" src="/posts/finance/stock_prediction/sarima/images/sarima_example_12_0.png"></p>
<p>These diagnostic plots help us check for:</p>
<ol>
<li><strong>Standardized residual</strong>: Should resemble white noise</li>
<li><strong>Histogram plus KDE</strong>: Should be normally distributed</li>
<li><strong>Q-Q plot</strong>: Should follow the straight line</li>
<li><strong>Correlogram</strong>: Should show no significant autocorrelation</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>The SARIMA model provides a powerful tool for analyzing and forecasting time series data with both trend and seasonal components. By decomposing the Apple stock price series and applying a SARIMA model, we&rsquo;ve gained insights into the underlying patterns and potential future movements of the stock.</p>
<p>Key takeaways:</p>
<ol>
<li>Signal decomposition revealed clear trend and seasonal components in Apple&rsquo;s stock price.</li>
<li>The SARIMA model captures both non-seasonal and seasonal patterns in the data.</li>
<li>Model diagnostics are crucial for ensuring the validity of our forecasts.</li>
</ol>
<p>Remember that while these models can provide valuable insights, stock prices are influenced by many external factors not captured in historical data alone. Always combine statistical analysis with fundamental research and an understanding of market conditions when making investment decisions.</p>

        </div>

        
        <div class="row ps-3 pe-3">
        
          <div class="col-md-6 share-buttons">
          
            <strong>Share on:</strong>
            
            <a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fsarima%2f" target="_blank">
              <i class="fab fa-facebook"></i>
            </a>
            
            
                <a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fsarima%2f&text=Time%20Series%20Analysis%20and%20SARIMA%20Model%20for%20Stock%20Price%20Prediction&via=Stefano%20Giannini" target="_blank">
                  <i class="fab fa-twitter"></i>
                </a>
            
            
                <a  class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fsarima%2f&title=Time%20Series%20Analysis%20and%20SARIMA%20Model%20for%20Stock%20Price%20Prediction" target="_blank">
                  <i class="fab fa-reddit"></i>
                </a>
            
            
            
            
                <a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fsarima%2f&title=Time%20Series%20Analysis%20and%20SARIMA%20Model%20for%20Stock%20Price%20Prediction" target="_blank">
                  <i class="fab fa-linkedin"></i>
                </a>
            
            
             
            
                 <a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=Time%20Series%20Analysis%20and%20SARIMA%20Model%20for%20Stock%20Price%20Prediction http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fsarima%2f" target="_blank">
                  <i class="fab fa-whatsapp"></i>
                </a>
            
            
                <a class="btn icon-button" href="mailto:?subject=Time%20Series%20Analysis%20and%20SARIMA%20Model%20for%20Stock%20Price%20Prediction&body=http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fsarima%2f" target="_blank">
                  <i class="fas fa-envelope-open-text"></i>
                </a>
            
          
          </div>

        
        
          
            
          
          <div class="col-md-6 btn-improve-page">
             
               <a href="https://github.com/ragespin/ragespin.github.io/edit/main/content/posts%5cfinance%5cstock_prediction%5cSARIMA%5cindex.md" title="Improve this page" target="_blank" rel="noopener">
            
                <i class="fas fa-code-branch"></i>
                Improve this page
              </a>
          </div>
        
        </div>



      
      <hr />
        







  





  
  

  
  

  
  

  
    
    
  
  

  
  

  
  

  
  

  
  

  
  


<div class="row next-prev-navigator">
  
    <div class="col-md-6 previous-article">
      <a href="/posts/finance/stock_prediction/arima/" title="Time Series Analysis and ARIMA Models for Stock Price Prediction" class="btn filled-button">
        <div><i class="fas fa-chevron-circle-left"></i> Prev</div>
        <div class="next-prev-text">Time Series Analysis and ARIMA Models for Stock Price Prediction</div>
      </a>
    </div>
  
  
      
      
        
      
      <div class="col-md-6 next-article">
        <a href="/posts/finance/stock_prediction/sarimax/" title="SARIMAX Model Analysis of Apple Stock with Exogenous Variables" class="btn filled-button">
          <div>Next <i class="fas fa-chevron-circle-right"></i></div>
          <div class="next-prev-text">SARIMAX Model Analysis of Apple Stock with Exogenous Variables</div>
        </a>
      </div>
    
</div>

      <hr />

      
      

      
      

      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn" type="button" data-bs-toggle="tooltip" data-bs-placement="left" title="Scroll to top">
    <i class="fas fa-chevron-circle-up"></i>
  </a>
</section>


      
      
  <section class="toc-section" id="toc-section">
    
    <div class="toc-holder">
      <h5 class="text-center ps-3">Table of Contents</h5>
      <hr>
      <div class="toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#1-data-preparation-and-exploration">1. Data Preparation and Exploration</a></li>
    <li><a href="#2-signal-decomposition">2. Signal Decomposition</a></li>
    <li><a href="#3-mathematical-formulation-of-sarima">3. Mathematical Formulation of SARIMA</a></li>
    <li><a href="#4-sarima-model-implementation">4. SARIMA Model Implementation</a></li>
    <li><a href="#5-model-diagnostics">5. Model Diagnostics</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
      </div>
    </div>
    
  </section>

    </div>

    
    












  
  
    
  

  
  
    
  

  
  
    
  

  
  
    
    
      
    
  


  
  
  
    
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-start">
        
        
        
        
      </div>
    </div>
    
    <hr />
    <div class="container">
      <p id="disclaimer"><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-start">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hugo-toha/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png" alt="Toha Theme Logo">
            Toha
          </a>
        </div>
        <div class="col-md-4 text-center">© 2024 Copyright.</div>
        <div class="col-md-4 text-end">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script src="/application.97f51c3e286071444c3471235d1690400d75a930a8787cc86f8c8e4d2767277e.js" integrity="sha256-l/UcPihgcURMNHEjXRaQQA11qTCoeHzIb4yOTSdnJ34=" defer></script>


    
     

    
    

</body>
</html>
