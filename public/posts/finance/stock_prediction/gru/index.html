<!DOCTYPE html>
<html lang="en">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <title>MSFT Stock Prediction using LSTM or GRU</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />

<link rel="stylesheet" href="/application.fba7e2c0b4d0535aec97a3442d40338651f3354b1ee38f3630059796de18930f.css" integrity="sha256-&#43;6fiwLTQU1rsl6NELUAzhlHzNUse4482MAWXlt4Ykw8=" />





  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="/images/site/icon_hu65d76dfee5a8e0802e55f59432358110_6732567_42x0_resize_box_3.png" />

<meta property="og:url" content="http://localhost:1313/posts/finance/stock_prediction/gru/">
  <meta property="og:site_name" content="Stefano Giannini">
  <meta property="og:title" content="MSFT Stock Prediction using LSTM or GRU">
  <meta property="og:description" content="Short Stock price analysis on MSFT, then a prediction is tested using GRU">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-06-16T00:00:00+01:00">
    <meta property="article:modified_time" content="2024-06-16T00:00:00+01:00">
    <meta property="article:tag" content="Finance">
    <meta property="article:tag" content="Deep Learning">
    <meta property="article:tag" content="Forecasting">

    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="MSFT Stock Prediction using LSTM or GRU">
  <meta name="twitter:description" content="Short Stock price analysis on MSFT, then a prediction is tested using GRU">

    
    
<meta name="description" content="Short Stock price analysis on MSFT, then a prediction is tested using GRU" />


    

    




<script>
      theme = localStorage.getItem('darkmode:color-scheme') || 'system';
      if (theme == 'system') {
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          theme = 'dark';
        } else {
          theme = 'light';
        }
      }
      document.documentElement.setAttribute('data-theme', theme);
    </script>
  </head>

  <body class="type-posts kind-page" data-bs-spy="scroll" data-bs-target="#TableOfContents" data-bs-offset="80">
    <div class="container-fluid bg-secondary wrapper">
      
      
    













  


  




  
  
    
  
  



  
  
    
  
  










  




  


<nav class="navbar navbar-expand-xl top-navbar shadow " id="top-navbar">
  <div class="container">
    
    <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button">
      <i data-feather="sidebar"></i>
    </button>
    
    <a class="navbar-brand" href="/">
      
        <img src="/images/site/icon_hu65d76dfee5a8e0802e55f59432358110_6732567_42x0_resize_box_3.png" id="logo" alt="Logo">
      Stefano Giannini</a>
    <button
      class="navbar-toggler navbar-light"
      id="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#top-nav-items"
      aria-label="menu"
    >
      <i data-feather="menu"></i>
    </button>

    <div class="collapse navbar-collapse dynamic-navbar" id="top-nav-items">
      <ul class="nav navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link" href="/#home">Home</a>
        </li>
        
          
          
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#about">About</a>
                </li>
              
            
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#skills">Skills</a>
                </li>
              
            
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#experiences">Experiences</a>
                </li>
              
            
            
              
              
                <li class="nav-item">
                  <a class="nav-link" href="/#education">Education</a>
                </li>
              
            
          
        
        
          <div id="top-navbar-divider"></div>
        
        
          <li class="nav-item">
            <a class="nav-link" id="blog-link" href="/posts">Posts</a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" id="note-link" href="/notes">Notes</a>
          </li>
        
        
        
        
      </ul>
    </div>
  </div>
  
  
    <img src="/images/site/icon_hu65d76dfee5a8e0802e55f59432358110_6732567_42x0_resize_box_3.png" class="d-none" id="main-logo" alt="Logo">
  
  
    <img src="/images/site/icon_hu65d76dfee5a8e0802e55f59432358110_6732567_42x0_resize_box_3.png" class="d-none" id="inverted-logo" alt="Inverted Logo">
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="/search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts/" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
    
    
  
  
    
    <li>
      <i data-feather="minus-circle"></i><a class="active list-link" href="/posts/finance/"> Finance</a>
      
      <ul class="active">
        
  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/finance/monte_carlo/"> Monte Carlo</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/finance/monte_carlo/black-scholes/" title="Option Pricing">Option Pricing</a></li>
  


      </ul>
    </li>
  

  
  
  
  
    
    
  
  
    
    <li>
      <i data-feather="minus-circle"></i><a class="active list-link" href="/posts/finance/stock_prediction/"> Stock Prediction</a>
      
      <ul class="active">
        
  
  
  
  
    
    
  
  
    
    <li><a class="active list-link" href="/posts/finance/stock_prediction/gru/" title="GRU">GRU</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/finance/stock_prediction/arima/" title="ARIMA">ARIMA</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/finance/stock_prediction/sarima/" title="SARIMA">SARIMA</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/finance/stock_prediction/sarimax/" title="SARIMAX">SARIMAX</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/machine-learning/"> Machine Learning</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/machine-learning/deep-learning/"> Deep Learning</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/machine-learning/deep-learning/computer-vision/"> Computer Vision</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/machine-learning/deep-learning/computer-vision/florence/" title="Florence-2 LVM">Florence-2 LVM</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/machine-learning/deep-learning/nlp/"> NLP</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/machine-learning/deep-learning/nlp/gemma2&#43;rag/" title="Gemma-2 &#43; RAG">Gemma-2 &#43; RAG</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/physics/"> Physics</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/physics/percolation/" title="Percolation">Percolation</a></li>
  

  
  
  
  
  
    
    <li>
      <i data-feather="plus-circle"></i><a class=" list-link" href="/posts/physics/quantum_computing/"> Quantum Computing</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/physics/quantum_computing/introduction/" title="Introduction">Introduction</a></li>
  

  
  
  
  
  
    
    <li><a class=" list-link" href="/posts/physics/quantum_computing/teleportation/" title="Teleportation">Teleportation</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(/posts/finance/stock_prediction/gru/images/stock-market-prediction-using-data-mining-techniques.jpg);'>
      </div>

      
      <div class="page-content">
        
        <div class="author-profile ms-auto align-self-lg-center">
          <img class="rounded-circle" src='/images/author/profile_hu8a567cefac8c1a165d433ac0796ac418_3088978_120x120_fit_q75_box.jpg' alt="Author Image">
          <h5 class="author-name">Stefano Giannini</h5>
          <p class="text-muted">Sunday, June 16, 2024 | 6 minutes</p>
        </div>
        
        
        <div class="title">
          <h1>MSFT Stock Prediction using LSTM or GRU</h1>
        </div>

        

        
          <div class="tags">
  <ul style="padding-left: 0;">
    
    
    <li class="rounded"><a href="/tags/finance/" class="btn btn-sm btn-info">Finance</a></li>
    
    
    <li class="rounded"><a href="/tags/deep-learning/" class="btn btn-sm btn-info">Deep Learning</a></li>
    
    
    <li class="rounded"><a href="/tags/forecasting/" class="btn btn-sm btn-info">Forecasting</a></li>
    
  </ul>
</div>

        
        <div class="post-content" id="post-content">
          <h2 id="introduction">Introduction</h2>
<p>In this article, we will explore time series data extracted from the <strong>stock market</strong>, focusing on prominent technology companies such as Apple, Amazon, Google, and Microsoft. Our objective is to equip data analysts and scientists with the essential skills to effectively manipulate and interpret stock market data.</p>
<p>To achieve this, we will utilize the <em>yfinance</em> library to fetch stock information and leverage visualization tools such as Seaborn and Matplotlib to illustrate various facets of the data. Specifically, we will explore methods to analyze stock risk based on historical performance, and implement predictive modeling using <strong>GRU/ LSTM</strong> models.</p>
<p>Throughout this tutorial, we aim to address the following key questions:</p>
<ol>
<li>How has the stock price evolved over time?</li>
<li>What is the average <strong>daily return</strong> of the stock?</li>
<li>How does the <strong>moving average</strong> of the stocks vary?</li>
<li>What is the <strong>correlation</strong> between different stocks?</li>
<li>How can we forecast future stock behavior, exemplified by predicting the closing price of Apple Inc. using LSTM or GRU?&quot;</li>
</ol>
<hr>
<h2 id="getting-data">Getting Data</h2>
<p>The initial step involves <strong>acquiring and loading</strong> the data into memory. Our source of stock data is the <strong>Yahoo Finance</strong> website, renowned for its wealth of financial market data and investment tools. To access this data, we&rsquo;ll employ the <strong>yfinance</strong> library, known for its efficient and Pythonic approach to downloading market data from Yahoo. For further insights into yfinance, refer to the article titled <a href="https://aroussi.com/post/python-yahoo-finance" target="_blank" rel="noopener">Reliably download historical market data from with Python</a>.</p>
<h3 id="install-dependencies">Install Dependencies</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install -qU yfinance seaborn
</span></span></code></pre></div><h3 id="configuration-code">Configuration Code</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> seaborn <span style="color:#66d9ef">as</span> sns
</span></span><span style="display:flex;"><span>sns<span style="color:#f92672">.</span>set_style(<span style="color:#e6db74">&#39;whitegrid&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>style<span style="color:#f92672">.</span>use(<span style="color:#e6db74">&#34;fivethirtyeight&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">%</span>matplotlib inline <span style="color:#75715e">#comment if you are not using a jupyter notebook</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For reading stock data from yahoo</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pandas_datareader.data <span style="color:#f92672">import</span> DataReader
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> yfinance <span style="color:#66d9ef">as</span> yf
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pandas_datareader <span style="color:#f92672">import</span> data <span style="color:#66d9ef">as</span> pdr
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>yf<span style="color:#f92672">.</span>pdr_override()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># For time stamps</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> datetime <span style="color:#f92672">import</span> datetime
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get Microsoft data</span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> yf<span style="color:#f92672">.</span>download(<span style="color:#e6db74">&#34;MSFT&#34;</span>, start, end)
</span></span></code></pre></div><h2 id="statistical-analysis-on-the-price">Statistical Analysis on the price</h2>
<h3 id="summary">Summary</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Summary Stats</span>
</span></span><span style="display:flex;"><span>data<span style="color:#f92672">.</span>describe()
</span></span></code></pre></div><h3 id="closing-price">Closing Price</h3>
<p>The closing price is the last price at which the stock is traded during the regular trading day. A stock’s closing price is the standard benchmark used by investors to track its performance over time.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(data[<span style="color:#e6db74">&#39;Adj Close&#39;</span>], label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Close Price&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Date&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Close Price [$]&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Stock Price History&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h3 id="volume-of-sales">Volume of Sales</h3>
<p>Volume is the amount of an asset or security that <em>changes hands over some period of time</em>, often over the course of a day. For instance, the stock trading volume would refer to the number of shares of security traded between its daily open and close. Trading volume, and changes to volume over the course of time, are important inputs for technical traders.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>plot(data[<span style="color:#e6db74">&#39;Volume&#39;</span>], label<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Volume&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Date&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Volume&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Stock Price History&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h3 id="moving-average">Moving Average</h3>
<p>The moving average (MA) is a simple <strong>technical analysis</strong> tool that smooths out price data by creating a constantly updated average price. The average is taken over a specific period of time, like 10 days, 20 minutes, 30 weeks, or any time period the trader chooses.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ma_day <span style="color:#f92672">=</span> [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">50</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># compute moving average (can be also done in a vectorized way)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> ma <span style="color:#f92672">in</span> ma_day:
</span></span><span style="display:flex;"><span>  column_name <span style="color:#f92672">=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">{</span>ma<span style="color:#e6db74">}</span><span style="color:#e6db74"> days MA&#34;</span>
</span></span><span style="display:flex;"><span>  data[column_name] <span style="color:#f92672">=</span> data[<span style="color:#e6db74">&#39;Adj Close&#39;</span>]<span style="color:#f92672">.</span>rolling(ma)<span style="color:#f92672">.</span>mean()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>data[[<span style="color:#e6db74">&#39;Adj Close&#39;</span>, <span style="color:#e6db74">&#39;10 days MA&#39;</span>, <span style="color:#e6db74">&#39;20 days MA&#39;</span>, <span style="color:#e6db74">&#39;50 days MA&#39;</span>]]<span style="color:#f92672">.</span>plot()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Date&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Volume&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Stock Price History&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h2 id="statistical-analysis-on-the-returns">Statistical Analysis on the returns</h2>
<p>Now that we&rsquo;ve done some baseline analysis, let&rsquo;s go ahead and dive a little deeper. We&rsquo;re now going to analyze the risk of the stock. In order to do so we&rsquo;ll need to take a closer look at the daily changes of the stock, and not just its absolute value. Let&rsquo;s go ahead and use pandas to retrieve teh daily returns for the <strong>Microsoft</strong> stock.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Compute daily return in percentage</span>
</span></span><span style="display:flex;"><span>data[<span style="color:#e6db74">&#39;Daily Return&#39;</span>] <span style="color:#f92672">=</span> data[<span style="color:#e6db74">&#39;Adj Close&#39;</span>]<span style="color:#f92672">.</span>pct_change()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># simple plot</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>data[<span style="color:#e6db74">&#39;Daily Return&#39;</span>]<span style="color:#f92672">.</span>hist(bins<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;MSFT Daily Return Distribution&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Daily Return&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># histogram</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
</span></span><span style="display:flex;"><span>data[<span style="color:#e6db74">&#39;Daily Return&#39;</span>]<span style="color:#f92672">.</span>plot()
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;MSFT Daily Return&#39;</span>)
</span></span><span style="display:flex;"><span>plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h2 id="data-preparation">Data Preparation</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Create a new dataframe with only the &#39;Close column </span>
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> data<span style="color:#f92672">.</span>filter([<span style="color:#e6db74">&#39;Adj Close&#39;</span>])
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Convert the dataframe to a numpy array</span>
</span></span><span style="display:flex;"><span>X <span style="color:#f92672">=</span> X<span style="color:#f92672">.</span>values
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the number of rows to train the model on</span>
</span></span><span style="display:flex;"><span>training_data_len <span style="color:#f92672">=</span> int(np<span style="color:#f92672">.</span>ceil(len(X)<span style="color:#f92672">*</span><span style="color:#ae81ff">.95</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Scale data</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> MinMaxScaler
</span></span><span style="display:flex;"><span>scaler <span style="color:#f92672">=</span> MinMaxScaler(feature_range<span style="color:#f92672">=</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>scaled_data <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>fit_transform(X)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scaled_data
</span></span></code></pre></div><p>Split training data into small chunks to ingest into LSTM and GRU</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Create the training data set </span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create the scaled training data set</span>
</span></span><span style="display:flex;"><span>train_data <span style="color:#f92672">=</span> scaled_data[<span style="color:#ae81ff">0</span>:int(training_data_len), :]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Split the data into x_train and y_train data sets</span>
</span></span><span style="display:flex;"><span>x_train <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>y_train <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>seq_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">60</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(seq_length, len(train_data)):
</span></span><span style="display:flex;"><span>    x_train<span style="color:#f92672">.</span>append(train_data[i<span style="color:#f92672">-</span><span style="color:#ae81ff">60</span>:i, <span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>    y_train<span style="color:#f92672">.</span>append(train_data[i, <span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">&lt;=</span> seq_length<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        print(x_train)
</span></span><span style="display:flex;"><span>        print(y_train, end<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Convert the x_train and y_train to numpy arrays </span>
</span></span><span style="display:flex;"><span>x_train, y_train <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(x_train), np<span style="color:#f92672">.</span>array(y_train)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Reshape the data</span>
</span></span><span style="display:flex;"><span>x_train <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>reshape(x_train, (x_train<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>], x_train<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">1</span>))
</span></span></code></pre></div><h2 id="gru">GRU</h2>
<p>Gated-Recurrent Unit (GRU) is adopted in this part</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> tensorflow.keras.models <span style="color:#f92672">import</span> Sequential
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> GRU, Dense, Dropout
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lstm_model <span style="color:#f92672">=</span> Sequential()
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>add(GRU(units<span style="color:#f92672">=</span><span style="color:#ae81ff">128</span>, return_sequences<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, input_shape<span style="color:#f92672">=</span>(seq_length, <span style="color:#ae81ff">1</span>)))
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.2</span>))
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>add(GRU(units<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span>, return_sequences<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>))
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.2</span>))
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>add(Dense(units<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>compile(optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>, loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mean_squared_error&#39;</span>)
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>fit(x_train, y_train, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>)
</span></span></code></pre></div><h2 id="lstm">LSTM</h2>
<p>Long Short-Term Memory (LSTM) is adopted in this part</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> LSTM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lstm_model <span style="color:#f92672">=</span> Sequential()
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>add(LSTM(units<span style="color:#f92672">=</span><span style="color:#ae81ff">128</span>, return_sequences<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, input_shape<span style="color:#f92672">=</span>(seq_length, <span style="color:#ae81ff">1</span>)))
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.2</span>))
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>add(LSTM(units<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span>, return_sequences<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>))
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.2</span>))
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>add(Dense(units<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>compile(optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>, loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mean_squared_error&#39;</span>)
</span></span><span style="display:flex;"><span>lstm_model<span style="color:#f92672">.</span>fit(x_train, y_train, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">8</span>)
</span></span></code></pre></div><h2 id="testing-metrics">Testing Metrics</h2>
<ul>
<li>root mean squared error (RMSE)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create the testing data set</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create a new array containing scaled values from index 1543 to 2002 </span>
</span></span><span style="display:flex;"><span>test_data <span style="color:#f92672">=</span> scaled_data[training_data_len <span style="color:#f92672">-</span> <span style="color:#ae81ff">60</span>: , :]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create the data sets x_test and y_test</span>
</span></span><span style="display:flex;"><span>x_test <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>y_test <span style="color:#f92672">=</span> dataset[training_data_len:, :]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">60</span>, len(test_data)):
</span></span><span style="display:flex;"><span>    x_test<span style="color:#f92672">.</span>append(test_data[i<span style="color:#f92672">-</span><span style="color:#ae81ff">60</span>:i, <span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Convert the data to a numpy array</span>
</span></span><span style="display:flex;"><span>x_test <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(x_test)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Reshape the data</span>
</span></span><span style="display:flex;"><span>x_test <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>reshape(x_test, (x_test<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>], x_test<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">1</span> ))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the models predicted price values </span>
</span></span><span style="display:flex;"><span>predictions_gru <span style="color:#f92672">=</span> gru_model<span style="color:#f92672">.</span>predict(x_test)
</span></span><span style="display:flex;"><span>predictions_gru <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>inverse_transform(predictions_gru)
</span></span><span style="display:flex;"><span>predictions_lstm <span style="color:#f92672">=</span> lstm_model<span style="color:#f92672">.</span>predict(x_test)
</span></span><span style="display:flex;"><span>predictions_lstm <span style="color:#f92672">=</span> scaler<span style="color:#f92672">.</span>inverse_transform(predictions_lstm)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get the root mean squared error (RMSE)</span>
</span></span><span style="display:flex;"><span>rmse_lstm <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(np<span style="color:#f92672">.</span>mean(((predictions_lstm <span style="color:#f92672">-</span> y_test) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>)))
</span></span><span style="display:flex;"><span>rmse_gru <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(np<span style="color:#f92672">.</span>mean(((predictions_gru <span style="color:#f92672">-</span> y_test) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>)))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;LSTM RMSE: </span><span style="color:#e6db74">{</span>rmse_lstm<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, GRU RMSE: </span><span style="color:#e6db74">{</span>rmse_gru<span style="color:#e6db74">:</span><span style="color:#e6db74">.4f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><blockquote>
<p>&ldquo;LSTM RMSE: <strong>4.2341</strong>, GRU RMSE: 3.3575&rdquo;</p>
</blockquote>
<h3 id="test-plot">Test Plot</h3>
<p><img src="/posts/finance/stock_prediction/GRU/images/test_results.png"
    
        alt="Results"
    
    
    
    
    
        class="center"
    
>

GRU-based model shows a bit better results both graphically and on MSE. However, this does not tell us anything about the actual profitability of these models.</p>
<h2 id="possible-trading-performance">Possible trading performance</h2>
<p>The strategy implementation is:</p>
<ul>
<li>BUY: if prediction &gt; actual_price</li>
<li>SELL: if prediction &lt; actual_price</li>
</ul>
<p>To close a position the next candle <em>close</em> is waited. However, LSTM and GRU has some offset that does not allow a proper utilization of this strategy.</p>
<p>Hence, the <strong>returns</strong> of the predictions are adopted.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># Assume a trading capital of $10,000</span>
</span></span><span style="display:flex;"><span>trading_capital <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>pred_gru_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(predictions_gru, columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Price&#39;</span>])
</span></span><span style="display:flex;"><span>pred_test_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(y_test, columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;Price&#39;</span>])
</span></span><span style="display:flex;"><span>pred_gru_df[<span style="color:#e6db74">&#39;returns&#39;</span>] <span style="color:#f92672">=</span> pred_gru_df<span style="color:#f92672">.</span>pct_change(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>pred_test_df[<span style="color:#e6db74">&#39;returns&#39;</span>] <span style="color:#f92672">=</span> pred_test_df<span style="color:#f92672">.</span>pct_change(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Compute Wins</span>
</span></span><span style="display:flex;"><span>wins <span style="color:#f92672">=</span> ((pred_gru_df<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>returns<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>) <span style="color:#f92672">&amp;</span> (pred_test_df<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>returns<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">0</span>)) <span style="color:#f92672">|</span> ((pred_gru_df<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>returns<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>) <span style="color:#f92672">&amp;</span> (pred_test_df<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>returns<span style="color:#f92672">&gt;</span><span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>print(wins<span style="color:#f92672">.</span>value_counts())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>returns_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>concat([pred_gru_df<span style="color:#f92672">.</span>returns, pred_test_df<span style="color:#f92672">.</span>returns], axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">.</span>dropna()
</span></span><span style="display:flex;"><span>total_pos_return <span style="color:#f92672">=</span> pred_test_df<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>returns[wins]<span style="color:#f92672">.</span>abs()<span style="color:#f92672">.</span>sum()
</span></span><span style="display:flex;"><span>total_neg_return <span style="color:#f92672">=</span> pred_test_df<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>returns[np<span style="color:#f92672">.</span>logical_not(wins)]<span style="color:#f92672">.</span>abs()<span style="color:#f92672">.</span>sum()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># compute final capital and compare with BUY&amp;HOLD strategy</span>
</span></span><span style="display:flex;"><span>final_capital <span style="color:#f92672">=</span> trading_capital<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>total_pos_return<span style="color:#f92672">-</span>total_neg_return)
</span></span><span style="display:flex;"><span>benchmark_return <span style="color:#f92672">=</span> (valid<span style="color:#f92672">.</span>Close<span style="color:#f92672">.</span>iloc[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> valid<span style="color:#f92672">.</span>Close<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>])<span style="color:#f92672">/</span>valid<span style="color:#f92672">.</span>Close<span style="color:#f92672">.</span>iloc[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>bench_capital <span style="color:#f92672">=</span> trading_capital<span style="color:#f92672">*</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">+</span>benchmark_return)
</span></span><span style="display:flex;"><span>print(final_capital, bench_capital)
</span></span></code></pre></div><blockquote>
<p>returns</p>
<p>True     81
False    72</p>
<p>Name: count, dtype: int64</p>
</blockquote>
<blockquote>
<p>10535.325 9617.617</p>
</blockquote>
<h2 id="conclusion">Conclusion</h2>
<p>As showed in the previous section, these two simple Deep Learning models exhibits interesting positive results both regarding regression and trading metrics.
The latter is particularly important, indeed a return of <strong>5%</strong> is obtained while the stock price decreased of approximately 4%. This also lead to a very high sharpe and colmar ratio.</p>

        </div>

        
        <div class="row ps-3 pe-3">
        
          <div class="col-md-6 share-buttons">
          
            <strong>Share on:</strong>
            
            <a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fgru%2f" target="_blank">
              <i class="fab fa-facebook"></i>
            </a>
            
            
            
                <a  class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fgru%2f&title=MSFT%20Stock%20Prediction%20using%20LSTM%20or%20GRU" target="_blank">
                  <i class="fab fa-reddit"></i>
                </a>
            
            
            
            
                <a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fgru%2f&title=MSFT%20Stock%20Prediction%20using%20LSTM%20or%20GRU" target="_blank">
                  <i class="fab fa-linkedin"></i>
                </a>
            
            
             
            
                 <a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=MSFT%20Stock%20Prediction%20using%20LSTM%20or%20GRU http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fgru%2f" target="_blank">
                  <i class="fab fa-whatsapp"></i>
                </a>
            
            
                <a class="btn icon-button" href="mailto:?subject=MSFT%20Stock%20Prediction%20using%20LSTM%20or%20GRU&body=http%3a%2f%2flocalhost%3a1313%2fposts%2ffinance%2fstock_prediction%2fgru%2f" target="_blank">
                  <i class="fas fa-envelope-open-text"></i>
                </a>
            
          
          </div>

        
        
          
            
          
          <div class="col-md-6 btn-improve-page">
             
               <a href="https://github.com/ragespin/ragespin.github.io/edit/main/content/posts%5cfinance%5cstock_prediction%5cGRU%5cindex.md" title="Improve this page" target="_blank" rel="noopener">
            
                <i class="fas fa-code-branch"></i>
                Improve this page
              </a>
          </div>
        
        </div>



      
      <hr />
        







  





  
  

  
    
    
  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  

  
  


<div class="row next-prev-navigator">
  
    <div class="col-md-6 previous-article">
      <a href="/posts/finance/monte_carlo/black-scholes/" title="Monte Carlo Simulation for Option Pricing" class="btn filled-button">
        <div><i class="fas fa-chevron-circle-left"></i> Prev</div>
        <div class="next-prev-text">Monte Carlo Simulation for Option Pricing</div>
      </a>
    </div>
  
  
      
      
        
      
      <div class="col-md-6 next-article">
        <a href="/posts/finance/stock_prediction/arima/" title="Time Series Analysis and ARIMA Models for Stock Price Prediction" class="btn filled-button">
          <div>Next <i class="fas fa-chevron-circle-right"></i></div>
          <div class="next-prev-text">Time Series Analysis and ARIMA Models for Stock Price Prediction</div>
        </a>
      </div>
    
</div>

      <hr />

      
      

      
      

      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn" type="button" data-bs-toggle="tooltip" data-bs-placement="left" title="Scroll to top">
    <i class="fas fa-chevron-circle-up"></i>
  </a>
</section>


      
      
  <section class="toc-section" id="toc-section">
    
    <div class="toc-holder">
      <h5 class="text-center ps-3">Table of Contents</h5>
      <hr>
      <div class="toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#getting-data">Getting Data</a>
      <ul>
        <li><a href="#install-dependencies">Install Dependencies</a></li>
        <li><a href="#configuration-code">Configuration Code</a></li>
      </ul>
    </li>
    <li><a href="#statistical-analysis-on-the-price">Statistical Analysis on the price</a>
      <ul>
        <li><a href="#summary">Summary</a></li>
        <li><a href="#closing-price">Closing Price</a></li>
        <li><a href="#volume-of-sales">Volume of Sales</a></li>
        <li><a href="#moving-average">Moving Average</a></li>
      </ul>
    </li>
    <li><a href="#statistical-analysis-on-the-returns">Statistical Analysis on the returns</a></li>
    <li><a href="#data-preparation">Data Preparation</a></li>
    <li><a href="#gru">GRU</a></li>
    <li><a href="#lstm">LSTM</a></li>
    <li><a href="#testing-metrics">Testing Metrics</a>
      <ul>
        <li><a href="#test-plot">Test Plot</a></li>
      </ul>
    </li>
    <li><a href="#possible-trading-performance">Possible trading performance</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
      </div>
    </div>
    
  </section>

    </div>

    
    












  
  
    
  

  
  
    
  

  
  

  
  
    
    
      
    
  


  
  
  
    
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer id="footer" class="container-fluid text-center align-content-center footer pb-2">
    <div class="container pt-5">
      <div class="row text-start">
        
        
        
        
      </div>
    </div>
    
    <hr />
    <div class="container">
      <p id="disclaimer"><strong>Liability Notice:</strong> This website is done experimentally by me, taking inspiration from the open-source Toha-Hugo theme.</p>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-start">
        <div class="col-md-4">
          <a id="theme" href="https://github.com/hugo-toha/toha" target="_blank" rel="noopener">
            <img src="/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png" alt="Toha Theme Logo">
            Toha
          </a>
        </div>
        <div class="col-md-4 text-center">© 2024 Copyright.</div>
        <div class="col-md-4 text-end">
          <a id="hugo" href="https://gohugo.io/" target="_blank" rel="noopener">Powered by
          <img
            src="/images/hugo-logo.svg"
            alt="Hugo Logo"
            height="18"
          />
          </a>
        </div>
      </div>
    </div>
    
  </footer>


    <script src="/application.6d2e94fc21563a9870dd3bb4b040f95f24aa53c948e98c0c55ae9bae328a5e9c.js" integrity="sha256-bS6U/CFWOphw3Tu0sED5XySqU8lI6YwMVa6brjKKXpw=" defer></script>


    
     

    
    

</body>
</html>
